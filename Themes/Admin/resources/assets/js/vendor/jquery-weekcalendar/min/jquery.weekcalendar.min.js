!function(e){var t=e.fn.jquery.split("."),n=10*t[0]+t[1]<15;e.widget("ui.weekCalendar",function(){var t,a;return{options:{date:new Date,timeFormat:null,dateFormat:"M d, Y",alwaysDisplayTimeMinutes:!0,use24Hour:!1,daysToShow:7,minBodyHeight:100,firstDayOfWeek:function(t){return 5!=e(t).weekCalendar("option","daysToShow")?0:1},useShortDayNames:!0,timeSeparator:" to ",startParam:"start",endParam:"end",businessHours:{start:8,end:18,limitDisplay:!1},newEventText:"New Event",timeslotHeight:20,defaultEventLength:2,timeslotsPerHour:4,minDate:null,maxDate:null,showHeader:!0,buttons:!0,buttonText:{today:"today",lastWeek:"previous",nextWeek:"next"},switchDisplay:{},scrollToHourMillis:500,allowEventDelete:!1,allowCalEventOverlap:!1,overlapEventsSeparate:!1,totalEventsWidthPercentInOneColumn:100,readonly:!1,allowEventCreation:!0,hourLine:!1,showSelectedTime:!1,selectedTime:{start:9,mid:13,end:17},deletable:function(){return!0},draggable:function(){return!0},resizable:function(){return!0},eventClick:function(){},eventRender:function(e,t){return t},eventAfterRender:function(e,t){return t},eventRefresh:function(e,t){return t},eventDrag:function(){},eventDrop:function(){},eventResize:function(){},eventNew:function(){},eventMouseover:function(){},eventMouseout:function(){},eventDelete:function(e,t,n,s){s.weekCalendar("removeEvent",e.id)},calendarBeforeLoad:function(){},calendarAfterLoad:function(){},noEvents:function(){},eventHeader:function(e,t){var n=t.weekCalendar("option"),s=36e5,i=e.end.getTime()-e.start.getTime()<=s/n.timeslotsPerHour;return i?t.weekCalendar("formatTime",e.start)+": "+e.title:t.weekCalendar("formatTime",e.start)+n.timeSeparator+t.weekCalendar("formatTime",e.end)},eventBody:function(e){return e.title},shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],users:[],showAsSeparateUsers:!1,getUserId:function(e,t){return t},getUserName:function(e){return e},getEventUserId:function(e){return e.userId},setEventUserId:function(e,t){return t.userId=e,t},displayFreeBusys:!1,getFreeBusyUserId:function(e){return e.userId},defaultFreeBusy:{free:!1},freeBusyRender:function(e,t){return e.free?t.addClass("free-busy-free"):t.addClass("free-busy-busy"),t},startOnFirstDayOfWeek:function(t){return e(t).weekCalendar("option","daysToShow")>=5},displayOddEven:!1,textSize:13,title:"%start%",jsonOptions:{},headerSeparator:"<br />",getHeaderDate:null,preventDragOnEventCreation:!1,resizeEvent:"resize.weekcalendar"},_create:function(){var t=this;t._computeOptions(),t._setupEventDelegation(),t._renderCalendar(),t._loadCalEvents(),t._resizeCalendar(),this.options.resizeEvent&&(e(window).unbind(this.options.resizeEvent),e(window).bind(this.options.resizeEvent,function(){t._resizeCalendar()}))},refresh:function(){this._loadCalEvents(this.element.data("startDate"))},clear:function(){this._clearCalendar()},today:function(){this._clearCalendar(),this._loadCalEvents(new Date)},prevWeek:function(){var e=new Date(this.element.data("startDate").getTime()-i/6);this._clearCalendar(),this._loadCalEvents(e)},nextWeek:function(){var e=new Date(this.element.data("startDate").getTime()+i+s);this._clearCalendar(),this._loadCalEvents(e)},gotoWeek:function(e){this._clearCalendar(),this._loadCalEvents(e)},gotoDate:function(e){this._clearCalendar(),this._loadCalEvents(e)},setDaysToShow:function(t){{var n=this;n._getCurrentScrollHour()}n.options.daysToShow=t,e(n.element).html(""),n._renderCalendar(),n._loadCalEvents(),n._resizeCalendar(),this.options.resizeEvent&&(e(window).unbind(this.options.resizeEvent),e(window).bind(this.options.resizeEvent,function(){n._resizeCalendar()}))},removeEvent:function(t){var n=this;n.element.find(".wc-cal-event").each(function(){return e(this).data("calEvent").id===t?(e(this).remove(),!1):void 0}),n.element.find(".wc-day-column-inner").each(function(){n._adjustOverlappingEvents(e(this))})},removeUnsavedEvents:function(){var t=this;t.element.find(".wc-new-cal-event").each(function(){e(this).remove()}),t.element.find(".wc-day-column-inner").each(function(){t._adjustOverlappingEvents(e(this))})},updateEvent:function(e){this._updateEventInCalendar(e)},getTimeslotTimes:function(e){for(var t=this.options,n=t.businessHours.limitDisplay?t.businessHours.start:0,s=new Date(e.getFullYear(),e.getMonth(),e.getDate(),n),i=[],a=s.getTime(),r=0;r<t.timeslotsPerDay;r++){var o=a+t.millisPerTimeslot;i[r]={start:new Date(a),startFormatted:this.formatTime(new Date(a),t.timeFormat),end:new Date(o),endFormatted:this.formatTime(new Date(o),t.timeFormat)},a=o}return i},formatDate:function(e,t){return t?this._formatDate(e,t):this._formatDate(e,this.options.dateFormat)},formatTime:function(e,t){return t?this._formatDate(e,t):this.options.timeFormat?this._formatDate(e,this.options.timeFormat):this.options.use24Hour?this._formatDate(e,"H:i"):this._formatDate(e,"h:i a")},serializeEvents:function(){var t=this,n=[];return t.element.find(".wc-cal-event").each(function(){n.push(e(this).data("calEvent"))}),n},next:function(){if(this._startOnFirstDayOfWeek())return this.nextWeek();var e=new Date(this.element.data("startDate").getTime());e.setDate(e.getDate()+this.options.daysToShow),this._clearCalendar(),this._loadCalEvents(e)},prev:function(){if(this._startOnFirstDayOfWeek())return this.prevWeek();var e=new Date(this.element.data("startDate").getTime());e.setDate(e.getDate()-this.options.daysToShow),this._clearCalendar(),this._loadCalEvents(e)},getCurrentFirstDay:function(){return this._dateFirstDayOfWeek(this.options.date||new Date)},getCurrentLastDay:function(){return this._addDays(this.getCurrentFirstDay(),this.options.daysToShow-1)},_setOption:function(t,n){var s=this;if(s.options[t]!=n){if("beforeEventNew"==t)return s.options[t]=n,void 0;var i=s.element.find(".wc-cal-event").map(function(){return e(this).data("calEvent")}),a={};a[t]=n,s._renderEvents({events:i,options:a},s.element.find(".wc-day-column-inner"))}},_computeOptions:function(){var e=this.options;e.businessHours.limitDisplay?(e.timeslotsPerDay=e.timeslotsPerHour*(e.businessHours.end-e.businessHours.start),e.millisToDisplay=36e5*(e.businessHours.end-e.businessHours.start),e.millisPerTimeslot=e.millisToDisplay/e.timeslotsPerDay):(e.timeslotsPerDay=24*e.timeslotsPerHour,e.millisToDisplay=s,e.millisPerTimeslot=s/e.timeslotsPerDay)},_resizeCalendar:function(){var t=this.options;if(t&&e.isFunction(t.height)){var n=t.height(this.element),s=this.element.find(".wc-header").outerHeight(),i=this.element.find(".wc-toolbar").outerHeight(),a=Math.max(n-i-s,t.minBodyHeight),r=this.element.find(".wc-time-slots").outerHeight();this.element.find(".wc-scrollable-grid").height("243px"),a>=r?this.element.find(".wc-scrollbar-shim").width(0):this.element.find(".wc-scrollbar-shim").width(this._findScrollBarWidth()),this._trigger("resize",this.element)}},_findScrollBarWidth:function(){var t=e('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),n=t.children(),s=n.innerWidth()-n.height(99).innerWidth();return t.remove(),s||16},_setupEventDelegation:function(){var t=this,n=this.options;this.element.click(function(s){var i,a=e(s.target);if(!a.data("preventClick")){var r=a.hasClass("wc-cal-event")?a:a.parents(".wc-cal-event");r.length&&r.data("calEvent")&&(i=t.getFreeBusyManagerForEvent(r.data("calEvent")),n.allowEventDelete&&a.hasClass("wc-cal-event-delete")?n.eventDelete(r.data("calEvent"),r,i,t.element,s):n.eventClick(r.data("calEvent"),r,i,t.element,s))}}).mouseover(function(s){var i=e(s.target),a=i.hasClass("wc-cal-event")?i:i.parents(".wc-cal-event");a.length&&a.data("calEvent")&&(t._isDraggingOrResizing(a)||n.eventMouseover(a.data("calEvent"),a,s))}).mouseout(function(s){var i=e(s.target),a=i.hasClass("wc-cal-event")?i:i.parents(".wc-cal-event");a.length&&a.data("calEvent")&&(t._isDraggingOrResizing(a)||n.eventMouseout(a.data("calEvent"),a,s))})},_isDraggingOrResizing:function(e){return e.hasClass("ui-draggable-dragging")||e.hasClass("ui-resizable-resizing")},_renderCalendar:function(){var t,n,s=this,i=this.options;t=e('<div class="ui-widget wc-container">').appendTo(s.element),s._renderCalendarButtons(t),s._renderCalendarHeader(t),s._renderCalendarBody(t),n=t.find(".wc-day-column-inner"),n.each(function(){i.readonly||(s._addDroppableToWeekDay(e(this)),i.allowEventCreation&&s._setupEventCreationForWeekDay(e(this)))})},_renderCalendarButtons:function(t){var n=this,s=this.options;if(s.showHeader)if(s.buttons){var i="";if(i+='<div class="ui-widget-header wc-toolbar">',i+='<div class="wc-display"></div>',i+='<div class="wc-nav">',i+='<button class="wc-prev">'+s.buttonText.lastWeek+"</button>",i+='<button class="wc-today">'+s.buttonText.today+"</button>",i+='<button class="wc-next">'+s.buttonText.nextWeek+"</button>",i+="</div>",i+='<h1 class="wc-title"></h1>',i+="</div>",e(i).appendTo(t),t.find(".wc-nav .wc-today").button({icons:{primary:"ui-icon-home"}}).click(function(){return n.today(),!1}),t.find(".wc-nav .wc-prev").button({text:!1,icons:{primary:"ui-icon-seek-prev"}}).click(function(){return n.element.weekCalendar("prev"),!1}),t.find(".wc-nav .wc-next").button({text:!1,icons:{primary:"ui-icon-seek-next"}}).click(function(){return n.element.weekCalendar("next"),!1}),this.options.switchDisplay&&e.isPlainObject(this.options.switchDisplay)){var a=t.find(".wc-display");e.each(this.options.switchDisplay,function(t,s){var i="wc-switch-display-"+s,r=e('<input type="radio" id="'+i+'" name="wc-switch-display" class="wc-switch-display"/>'),o=e('<label for="'+i+'"></label>');o.html(t),r.val(s),parseInt(n.options.daysToShow,10)===parseInt(s,10)&&r.attr("checked","checked"),a.append(r).append(o)}),a.find("input").change(function(){n.setDaysToShow(parseInt(e(this).val(),10))})}t.find(".wc-nav, .wc-display").buttonset();var r=t.find(".wc-nav").outerHeight();t.find(".wc-title").height(r).css("line-height",r+"px")}else{var i="";i+='<div class="ui-widget-header wc-toolbar">',i+='<h1 class="wc-title"></h1>',i+="</div>",e(i).appendTo(t)}},_renderCalendarHeader:function(t){var n,s=this,i=this.options,a=i.showAsSeparateUsers&&i.users&&i.users.length,r="",o="";a&&(r=' rowspan="2"',o=' colspan="'+i.users.length+'" '),n='<div class="ui-widget-content wc-header">',n+='<table><tbody><tr><td class="wc-time-column-header"></td>';for(var d=1;d<=i.daysToShow;d++)n+='<td class="wc-day-column-header wc-day-'+d+'"'+o+"></td>";if(n+='<td class="wc-scrollbar-shim"'+r+"></td></tr>",a){n+='<tr><td class="wc-time-column-header"></td>';for(var l=i.users.length,u="",d=1;d<=i.daysToShow;d++)for(var c=0;l>c;c++)u=[],0==c&&u.push("wc-day-column-first"),c==l-1&&u.push("wc-day-column-last"),u=u.length?u.join(" "):"wc-day-column-middle",n+='<td class="'+u+" wc-user-header wc-day-"+d+" wc-user-"+s._getUserIdFromIndex(c)+'">',n+=s._getUserName(c),n+="</td>";n+="</tr>"}n+="</tbody></table></div>",e(n).appendTo(t)},_renderCalendarBody:function(t){var n,s,i=this,a=this.options,r=a.showAsSeparateUsers&&a.users&&a.users.length;if(n='<div class="wc-scrollable-grid">',n+='<table class="wc-time-slots">',n+="<tbody>",n+="</tbody>",n+="</table>",n+="</div>",n=e(n),s=n.find("tbody"),i._renderCalendarBodyTimeSlots(s),i._renderCalendarBodyOddEven(s),i._renderCalendarBodyFreeBusy(s),i._renderCalendarBodyEvents(s),n.appendTo(t),t.find(".wc-full-height-column").height(1*a.timeslotHeight),t.find(".wc-time-slot").height(a.timeslotHeight),r)for(var o=0,d=a.users.length;d>o;o++)t.find(".wc-user-"+i._getUserIdFromIndex(o)).data("wcUser",a.users[o]).data("wcUserIndex",o).data("wcUserId",i._getUserIdFromIndex(o))},_renderCalendarBodyTimeSlots:function(t){var n,s,i,a=this.options,r=a.showAsSeparateUsers&&a.users&&a.users.length,o=(a.businessHours.limitDisplay?a.businessHours.start:0,a.businessHours.limitDisplay?a.businessHours.end:24,1);for(a.displayOddEven&&(o+=1),a.displayFreeBusys&&(o+=1),o=o>1?' rowspan="'+o+'"':"",n='<tr class="wc-grid-row-timeslot">',n+='<td class="wc-grid-timeslot-header"'+o+"></td>",n+='<td colspan="'+a.daysToShow*(r?a.users.length:1)+'">',n+='<div class="wc-no-height-wrapper wc-time-slot-wrapper">',n+='<div class="wc-time-slots">',s=0;3>s;s++){for(i=0;i<a.timeslotsPerHour-1;i++)n+='<div class="wc-time-slot"></div>';n+='<div class="wc-time-slot wc-hour-end"></div>'}n+="</div>",n+="</div>",n+="</td>",n+="</tr>",e(n).appendTo(t)},_renderCalendarBodyOddEven:function(t){if(this.options.displayOddEven){for(var n,s=this.options,i='<tr class="wc-grid-row-oddeven">',a=s.showAsSeparateUsers&&s.users&&s.users.length,r={odd:"wc-column-odd",even:"ui-state-hover wc-column-even"},o=1;o<=s.daysToShow;o++)if(a)for(var d=s.users.length,l=0;d>l;l++)n="odd"==n?"even":"odd",i+='<td class="wc-day-column day-'+o+'">',i+='<div class="wc-no-height-wrapper wc-oddeven-wrapper">',i+='<div class="wc-full-height-column '+r[n]+'" ></div>',i+="</div>",i+="</td>";else n="odd"==n?"even":"odd",i+='<td class="wc-day-column day-'+o+'">',i+='<div class="wc-no-height-wrapper wc-oddeven-wrapper">',i+='<div class="wc-full-height-column '+r[n]+'"></div>',i+="</div>",i+="</td>";i+="</tr>",e(i).appendTo(t)}},_renderCalendarBodyFreeBusy:function(t){if(this.options.displayFreeBusys){var n=this,s=this.options,i='<tr class="wc-grid-row-freebusy">',a=s.showAsSeparateUsers&&s.users&&s.users.length;i+="</td>";for(var r=1;r<=s.daysToShow;r++)if(s.displayFreeBusys)if(a)for(var o=s.users.length,d=0;o>d;d++)i+='<td class="wc-day-column day-'+r+'">',i+='<div class="wc-no-height-wrapper wc-freebusy-wrapper">',i+='<div class="wc-full-height-column wc-column-freebusy wc-day-'+r,i+=" wc-user-"+n._getUserIdFromIndex(d)+'">',i+="</div>",i+="</div>",i+="</td>";else i+='<td class="wc-day-column day-'+r+'">',i+='<div class="wc-no-height-wrapper wc-freebusy-wrapper">',i+='<div class="wc-full-height-column wc-column-freebusy wc-day-'+r+'"></div>',i+="</div>",i+="</td>";i+="</tr>",e(i).appendTo(t)}},_renderCalendarBodyEvents:function(t){var n,s=this,i=this.options,a=i.showAsSeparateUsers&&i.users&&i.users.length,r=i.businessHours.limitDisplay?i.businessHours.start:0,o=i.businessHours.limitDisplay?i.businessHours.end:24;if(n='<tr class="wc-grid-row-events">',n+='<td class="wc-grid-timeslot-header">',i.showSelectedTime)for(var d=0;3>d;d++){var l=i.businessHours.start<=d&&i.businessHours.end>d?"ui-state-active wc-business-hours":"ui-state-default";n+='<div class="wc-hour-header '+l+'">',n+='<div class="wc-time-header-cell">'+s._selected24HourForIndex(d)+"</div>",n+="</div>"}else for(var d=r;o>d;d++){var l=i.businessHours.start<=d&&i.businessHours.end>d?"ui-state-active wc-business-hours":"ui-state-default";n+='<div class="wc-hour-header '+l+'">',n+=i.use24Hour?'<div class="wc-time-header-cell">'+s._24HourForIndex(d)+"</div>":'<div class="wc-time-header-cell">'+s._hourForIndex(d)+'<span class="wc-am-pm">'+s._amOrPm(d)+"</span></div>",n+="</div>"}n+="</td>";for(var u="ui-state-default wc-day-column",c='<div class="add-slot"></div>',i=this.options,h=i.selectedTime.start,g=i.selectedTime.mid,v=i.selectedTime.end,d=1;d<=i.daysToShow;d++)if(a)for(var m,f=i.users.length,p=0;f>p;p++)m=[],0==p&&m.push("wc-day-column-first"),p==f-1&&m.push("wc-day-column-last"),m=m.length?m.join(" "):"wc-day-column-middle",n+='<td class="'+u+" "+m+" day-"+d+'">',n+='<div class="wc-full-height-column wc-day-column-inner day-'+d,n+=" wc-user-"+s._getUserIdFromIndex(p)+'">',n+="</div>",n+="</td>";else n+='<td class="'+u+" wc-day-column-first wc-day-column-last day-"+d+'">',n+='<div class="wc-full-height-column row-1 wc-day-column-inner day-'+d+" column-row-"+d+'" data-time="'+h+'"></div>',n+='<div class="wc-full-height-column row-2 wc-day-column-inner-2 day-'+d+" column-row-"+d+'" data-time="'+g+'"></div>',n+='<div class="wc-full-height-column row-3 wc-day-column-inner-3 day-'+d+" column-row-"+d+'" data-time="'+v+'"></div>',n+="</td>",e(".wc-full-height-column").append(c);n+="</tr>",e(n).appendTo(t)},_setupEventCreationForWeekDay:function(t){{var n=this,s=this.options;t.find(".sotr-add")}s.showSelectedTime?t.click(function(t){var i=e(t.target);if(i.hasClass("wc-day-column-inner")){var a=e('<div class="wc-cal-event wc-new-cal-event wc-new-cal-event-creating"></div>');a.css({lineHeight:s.timeslotHeight-2+"px",fontSize:s.timeslotHeight/2+"px"}),i.append(a);var r=i.offset().top,o=t.pageY-r,d=(o-o%s.timeslotHeight)/s.timeslotHeight,l=d*s.timeslotHeight;a.css({top:l});var i=e(t.target),u=i.closest(".wc-day-column-inner"),a=u.find(".wc-new-cal-event-creating");if(a.length){var c=!a.hasClass("ui-resizable-resizing");c&&a.css({height:s.timeslotHeight*s.defaultEventLength}).show();var h=parseInt(a.css("top")),g=n._getEventDurationFromPositionedEventElement(u,a,h);a.remove();var v={start:g.start,end:g.end,title:s.newEventText},m=s.showAsSeparateUsers&&s.users&&s.users.length;m?v=n._setEventUserId(v,u.data("wcUserId")):!s.showAsSeparateUsers&&s.users&&1==s.users.length&&(v=n._setEventUserId(v,n._getUserIdFromIndex(0)));var f=n.getFreeBusyManagerForEvent(v),p=n._renderEvent(v,u);s.allowCalEventOverlap?n._adjustOverlappingEvents(u):(n._adjustForEventCollisions(u,p,v,v),n._positionEvent(u,p));var w=n._trigger("beforeEventNew",t,{calEvent:v,createdFromSingleClick:c,calendar:n.element});w?s.eventNew(v,p,f,n.element,t):e(p).remove()}}}):t.mousedown(function(t){var n=e(t.target);if(n.hasClass("wc-day-column-inner")){var i=e('<div class="wc-cal-event wc-new-cal-event wc-new-cal-event-creating"></div>');i.css({lineHeight:s.timeslotHeight-2+"px",fontSize:s.timeslotHeight/2+"px"}),n.append(i);var a=n.offset().top,r=t.pageY-a,o=(r-r%s.timeslotHeight)/s.timeslotHeight,d=o*s.timeslotHeight;i.css({top:d}),s.preventDragOnEventCreation||n.bind("mousemove.newevent",function(e){i.show(),i.addClass("ui-resizable-resizing");var t=Math.round(e.pageY-a-d),n=t%s.timeslotHeight;if(0>n){var r=t-n;i.css("height",r<s.timeslotHeight?s.timeslotHeight:r)}else i.css("height",t+(s.timeslotHeight-n))}).mouseup(function(){n.unbind("mousemove.newevent"),i.addClass("ui-corner-all")})}}).mouseup(function(t){var i=e(t.target),a=i.closest(".wc-day-column-inner"),r=a.find(".wc-new-cal-event-creating");if(r.length){var o=!r.hasClass("ui-resizable-resizing");o&&r.css({height:s.timeslotHeight*s.defaultEventLength}).show();var d=parseInt(r.css("top")),l=n._getEventDurationFromPositionedEventElement(a,r,d);r.remove();var u={start:l.start,end:l.end,title:s.newEventText},c=s.showAsSeparateUsers&&s.users&&s.users.length;c?u=n._setEventUserId(u,a.data("wcUserId")):!s.showAsSeparateUsers&&s.users&&1==s.users.length&&(u=n._setEventUserId(u,n._getUserIdFromIndex(0)));var h=n.getFreeBusyManagerForEvent(u),g=n._renderEvent(u,a);s.allowCalEventOverlap?n._adjustOverlappingEvents(a):(n._adjustForEventCollisions(a,g,u,u),n._positionEvent(a,g));var v=n._trigger("beforeEventNew",t,{calEvent:u,createdFromSingleClick:o,calendar:n.element});v?s.eventNew(u,g,h,n.element,t):e(g).remove()}})},_loadCalEvents:function(s){var i,a,r,o,d=this,l=this.options;if(i=this._fixMinMaxDate(s||l.date),i&&i.getTime&&l.date&&l.date.getTime&&i.getTime()==l.date.getTime()||this._trigger("changedate",this.element,i),this.options.date=i,a=d._dateFirstDayOfWeek(i),r=d._dateLastMilliOfWeek(i),l.calendarBeforeLoad(d.element),d.element.data("startDate",a),d.element.data("endDate",r),o=d.element.find(".wc-day-column-inner"),d._updateDayColumnHeader(o),"string"==typeof l.data){l.loading&&l.loading(!0),t&&(n?(t.onreadystatechange=null,t.abort(),t=null,l.loading&&l.loading(!1)):t.abort());var u=d._getJsonOptions();u[l.startParam||"start"]=Math.round(a.getTime()/1e3),u[l.endParam||"end"]=Math.round(r.getTime()/1e3),t=e.ajax({url:l.data,data:u,dataType:"json",error:function(e,t,n){"abort"!=n&&0!=e.status&&alert("unable to get data, error:"+t)},success:function(e){d._renderEvents(e,o)},complete:function(){t=null,l.loading&&l.loading(!1)}})}else e.isFunction(l.data)?l.data(a,r,function(e){d._renderEvents(e,o)}):l.data&&d._renderEvents(l.data,o)},_drawCurrentHourLine:function(){var t=new Date,n=this.options,s=n.businessHours;if(e(".wc-hourline",this.element).remove(),!(s.limitDisplay&&t.getHours()>s.end)){var i=s.limitDisplay?s.start:0,a=t.getHours()-i+t.getMinutes()/60,r=a*n.timeslotHeight*n.timeslotsPerHour,o=e(".wc-scrollable-grid .wc-today",this.element).width()+3;e(".wc-scrollable-grid .wc-today",this.element).append(e("<div>",{"class":"wc-hourline",style:"top: "+r+"px; width: "+o+"px"}))}},_updateDayColumnHeader:function(t){var n=this,i=this.options,a=n._cloneDate(n.element.data("startDate")),r=i.showAsSeparateUsers&&i.users&&i.users.length,o="ui-state-active wc-today";if(n.element.find(".wc-header td.wc-day-column-header").each(function(){e(this).html(n._getHeaderDate(a)),n._isToday(a)?e(this).addClass(o):e(this).removeClass(o),a=n._addDays(a,1)}),a=n._cloneDate(n.element.data("startDate")),r&&n.element.find(".wc-header td.wc-user-header").each(function(t){n._isToday(a)?e(this).addClass(o):e(this).removeClass(o),a=(t+1)%i.users.length?a:n._addDays(a,1)}),a=n._cloneDate(n.element.data("startDate")),t.each(function(t){e(this).data("startDate",n._cloneDate(a)),e(this).data("endDate",new Date(a.getTime()+s)),n._isToday(a)?e(this).parent().addClass(o).removeClass("ui-state-default"):e(this).parent().removeClass(o).addClass("ui-state-default"),r&&(t+1)%i.users.length||(a=n._addDays(a,1))}),i.displayFreeBusys&&(a=n._cloneDate(n.element.data("startDate")),n.element.find(".wc-grid-row-freebusy .wc-column-freebusy").each(function(t){e(this).data("startDate",n._cloneDate(a)),e(this).data("endDate",new Date(a.getTime()+s)),r&&(t+1)%i.users.length||(a=n._addDays(a,1))})),this.options.title){var d=this.options.date,l=n._cloneDate(n.element.data("startDate")),u=(n._dateLastDayOfWeek(new Date(this._cloneDate(n.element.data("endDate")).getTime()-s)),this._getCalendarTitle()),c=i.dateFormat;u=u.replace("%start%",n._formatDate(l,"F Y")),u=u.replace("%date%",n._formatDate(d,c)),e(".wc-toolbar .wc-title",n.element).html(u)}},_getCalendarTitle:function(){return e.isFunction(this.options.title)?this.options.title(this.options.daysToShow):this.options.title||""},_renderEvents:function(t,n){var s,i=this,r=this.options,o=0;if(t.options){var d=!1;if(e.each(t.options,function(t,n){n!==r[t]&&(r[t]=n,d=d||e.ui.weekCalendar.updateLayoutOptions[t])}),i._computeOptions(),d){{i._getCurrentScrollHour()}i.element.empty(),i._renderCalendar(),n=i.element.find(".wc-time-slots .wc-day-column-inner"),i._updateDayColumnHeader(n),i._resizeCalendar()}}this._clearCalendar(),e.isArray(t)?s=i._cleanEvents(t):t.events&&(s=i._cleanEvents(t.events),i._renderFreeBusys(t)),e.each(s,function(e,t){for(var s,a=new Date(t.start),r=new Date(t.end),d=i.options.businessHours.limitDisplay?i.options.businessHours.end:24,l=i.options.businessHours.limitDisplay?i.options.businessHours.start:0,u=new Date(a),c=i._formatDate(u,"Ymd"),h=i._formatDate(r,"Ymd"),g=!1;h>c;)t.start=u,t.end.setFullYear(u.getFullYear()),t.end.setDate(u.getDate()),t.end.setMonth(u.getMonth()),t.end.setHours(d,0,0),(s=i._findWeekDayForEvent(t,n))&&(i._renderEvent(t,s),o+=1),u.setDate(u.getDate()+1),u.setHours(l,0,0),c=i._formatDate(u,"Ymd"),g=!0;r>=u&&(t.start=u,t.end=r,(g&&t.start.getTime()!=t.end.getTime()||!g)&&(s=i._findWeekDayForEvent(t,n))&&(i._renderEvent(t,s),o+=1)),t.start=a}),n.each(function(){i._adjustOverlappingEvents(e(this))}),r.calendarAfterLoad(i.element),a&&clearInterval(a),r.hourLine&&(i._drawCurrentHourLine(),a=setInterval(function(){i._drawCurrentHourLine()},6e4)),!o&&r.noEvents()},_renderEvent:function(t,n){var s=this,i=this.options;if(!(t.start.getTime()>t.end.getTime())){var a,r,o,d;if(i.showSelectedTime){a=t.id?"wc-cal-event":"wc-cal-event wc-new-cal-event",r='<div class="'+a+' ui-corner-all">';{t.class}t.id&&s.element.find(".wc-cal-event").each(function(){if("sotr-single"===e(this).data("calEvent").class)e(this).addClass("sotr-single");else if("sotr-twin"===e(this).data("calEvent").class)e(this).addClass("sotr-twin");else if("sotr-warning"===e(this).data("calEvent").class)e(this).addClass("sotr-warning");else if("sotr-close"===e(this).data("calEvent").class)e(this).addClass("sotr-close");else{if("sotr-add"!==e(this).data("calEvent").class)return;e(this).addClass("sotr-add")}})}else a=t.id?"wc-cal-event":"wc-cal-event wc-new-cal-event",r='<div class="'+a+' ui-corner-all">',r+='<div class="wc-time ui-corner-top"></div>',r+='<div class="wc-title"></div></div>';if(n.each(function(){var n=e(r);d=i.eventRender(t,n),n=d?d.appendTo(e(this)):n.appendTo(e(this)),n.css({lineHeight:i.textSize+2+"px",fontSize:i.textSize+"px"}),s._refreshEventDetails(t,n),s._positionEvent(e(this),n),o=o?o.add(n):n}),o.show(),!i.showSelectedTime)return!i.readonly&&i.resizable(t,o)&&s._addResizableToCalEvent(t,o,n),!i.readonly&&i.draggable(t,o)&&s._addDraggableToCalEvent(t,o),i.eventAfterRender(t,o),o}},addEvent:function(){return this._renderEvent.apply(this,arguments)},_adjustOverlappingEvents:function(t){var n=this;if(n.options.allowCalEventOverlap){var s=n._groupOverlappingEventElements(t);e.each(s,function(){var t=this;e.each(t,function(s){var i=this;if(n.options.overlapEventsSeparate)var a=n.options.totalEventsWidthPercentInOneColumn/t.length,r=s*a;else var a=n.options.totalEventsWidthPercentInOneColumn-10*(t.length-1),r=10*s;e.each(i,function(){n.options.overlapEventsSeparate||e(this).bind("mouseover.z-index",function(){var t=e(this);e.each(i,function(){e(this).css({"z-index":"1"})}),t.css({"z-index":"3"})}),e(this).css({width:a+"%",left:r+"%",right:0})})})})}},_groupOverlappingEventElements:function(t){var n,s=t.find(".wc-cal-event:visible"),i=s.sort(function(t,n){return e(t).data("calEvent").start.getTime()-e(n).data("calEvent").start.getTime()}),a=new Date(0,0,0),r=[],o=[];return e.each(i,function(){n=e(this),o.length>0&&a.getTime()<=n.data("calEvent").start.getTime()&&(r.push(o),o=[]);for(var t=0;t<o.length;t++)if(o[t].length>0&&o[t][o[t].length-1].data("calEvent").end.getTime()<=n.data("calEvent").start.getTime())return o[t].push(n),a.getTime()<n.data("calEvent").end.getTime()&&(a=n.data("calEvent").end),void 0;o.push([n]),a.getTime()<n.data("calEvent").end.getTime()&&(a=n.data("calEvent").end)}),o.length>0&&r.push(o),r},_findWeekDayForEvent:function(t,n){var s,i=this.options,a=i.showAsSeparateUsers&&i.users&&i.users.length,r=this._getEventUserId(t);return e.isArray(r)||(r=[r]),n.each(function(n,i){e(this).data("startDate").getTime()<=t.start.getTime()&&e(this).data("endDate").getTime()>=t.end.getTime()&&(!a||-1!==e.inArray(e(this).data("wcUserId"),r))&&(s=s?s.add(e(i)):e(i))}),s},_updateEventInCalendar:function(t){var n=this;n._cleanEvent(t),t.id&&n.element.find(".wc-cal-event").each(function(){(e(this).data("calEvent").id===t.id||e(this).hasClass("wc-new-cal-event"))&&e(this).remove()});var s=n._findWeekDayForEvent(t,n.element.find(".wc-grid-row-events .wc-day-column-inner"));s&&s.each(function(s,i){var a=e(i),r=n._renderEvent(t,a);n._adjustForEventCollisions(a,r,t,t),n._refreshEventDetails(t,r),n._positionEvent(a,r),n._adjustOverlappingEvents(a)})},_positionEvent:function(e,t){var n=this.options;if(n.showSelectedTime){t.data("calEvent").class}else{var s=t.data("calEvent"),i=e.height()/n.millisToDisplay,a=n.businessHours.limitDisplay?n.businessHours.start:0,r=(n.selectedTime.start,this._getDSTdayShift(s.start).getTime()-this._getDSTdayShift(new Date(s.start.getFullYear(),s.start.getMonth(),s.start.getDate(),a)).getTime()),o=this._getDSTdayShift(s.end).getTime()-this._getDSTdayShift(s.start).getTime(),d=i*r,l=i*o;t.css({top:d,height:l||36e5*i/n.timeslotsPerHour})}},_getEventDurationFromPositionedEventElement:function(e,t,n){var s=this.options,i=s.businessHours.limitDisplay?36e5*s.businessHours.start:0,a=new Date(e.data("startDate").getTime()+i+Math.round(n/s.timeslotHeight)*s.millisPerTimeslot),r=new Date(a.getTime()+t.height()/s.timeslotHeight*s.millisPerTimeslot);return{start:this._getDSTdayShift(a,-1),end:this._getDSTdayShift(r,-1)}},_adjustForEventCollisions:function(t,n,s,i,a){var r=this.options;if(!r.allowCalEventOverlap){var o,d,l=this;t.find(".wc-cal-event").not(n).each(function(){var t=e(this).data("calEvent");return s.start.getTime()<t.end.getTime()&&s.end.getTime()>=t.end.getTime()&&(o=t.end),s.end.getTime()>t.start.getTime()&&s.start.getTime()<=t.start.getTime()&&(d=t.start),0==i.resizable||s.end.getTime()<=t.end.getTime()&&s.start.getTime()>=t.start.getTime()?(o=i.start,d=i.end,!1):void 0}),s.start=o||s.start,o&&a?(s.end=new Date(o.getTime()+(i.end.getTime()-i.start.getTime())),l._adjustForEventCollisions(t,n,s,i)):s.end=d||s.end,s.start.getTime()>=s.end.getTime()&&(s.start=i.start,s.end=i.end),n.data("calEvent",s)}},_addDraggableToCalEvent:function(e,t){var n=this.options;n.showSelectedTime||t.draggable({handle:".wc-time",containment:"div.wc-time-slots",snap:".wc-day-column-inner",snapMode:"inner",snapTolerance:n.timeslotHeight-1,revert:"invalid",opacity:.5,grid:[t.outerWidth()+1,n.timeslotHeight],start:function(t,s){var i=s.draggable||s.helper;n.eventDrag(e,i)}})},_addDroppableToWeekDay:function(t){var n=this,s=this.options;s.showSelectedTime||t.droppable({accept:".wc-cal-event",drop:function(i,a){var r=a.draggable,o=Math.round(parseInt(a.position.top)),d=n._getEventDurationFromPositionedEventElement(t,r,o),l=r.data("calEvent"),u=e.extend(!0,{},l,{start:d.start,end:d.end}),c=s.showAsSeparateUsers&&s.users&&s.users.length;if(c){var h=t.data("wcUserId"),g=n._getEventUserId(l),v=e(a.draggable.parents(".wc-day-column-inner").get(0)).data("wcUserId");if(e.isArray(g)||(g=[g]),-1==e.inArray(h,g)){var m=e.inArray(v,g);g.splice(m,1),-1==e.inArray(h,g)&&g.push(h)}u=n._setEventUserId(u,1==g.length?g[0]:g)}n._adjustForEventCollisions(t,r,u,l,!0);var f=n.element.find(".wc-day-column-inner");s.eventDrop(u,l,r);n._renderEvent(u,n._findWeekDayForEvent(u,f));r.hide(),r.data("preventClick",!0);var p=n._findWeekDayForEvent(r.data("calEvent"),n.element.find(".wc-time-slots .wc-day-column-inner"));p.data("startDate")!=t.data("startDate")&&n._adjustOverlappingEvents(p),n._adjustOverlappingEvents(t),setTimeout(function(){r.remove()},1e3)}})},_addResizableToCalEvent:function(t,n,s){var i=this,a=this.options;n.resizable({grid:a.timeslotHeight,containment:s,handles:"s",minHeight:a.timeslotHeight,stop:function(n,r){var o=r.element,d=new Date(o.data("calEvent").start.getTime()+Math.max(1,Math.round(r.size.height/a.timeslotHeight))*a.millisPerTimeslot);i._needDSTdayShift(o.data("calEvent").start,d)&&(d=i._getDSTdayShift(d,-1));var l=e.extend(!0,{},t,{start:t.start,end:d});i._adjustForEventCollisions(s,o,l,t),a.eventResize(l,t,o),i._refreshEventDetails(l,o),i._positionEvent(s,o),i._adjustOverlappingEvents(s),o.data("preventClick",!0),setTimeout(function(){o.removeData("preventClick")},500)}}),e(".ui-resizable-handle",n).text("=")},_refreshEventDetails:function(e,t){var n="";!this.options.readonly&&this.options.allowEventDelete&&this.options.deletable(e,t)&&(n='<div class="wc-cal-event-delete ui-icon ui-icon-close"></div>'),t.find(".wc-time").html(this.options.eventHeader(e,this.element)+n),t.find(".wc-title").html(this.options.eventBody(e,this.element)),t.data("calEvent",e),this.options.eventRefresh(e,t)},_clearCalendar:function(){this.element.find(".wc-day-column-inner div").remove(),this._clearFreeBusys()},_hourForIndex:function(e){return 0===e?12:13>e?e:e-12},_24HourForIndex:function(e){return 0===e?"00:00":10>e?"0"+e+":00":e+":00"},_selected24HourForIndex:function(e){var t=this.options,n=t.selectedTime.start,s=t.selectedTime.mid,i=t.selectedTime.end;return 0===e?10>n?"0"+n+'<div class="sm">.00</div>':n+'<div class="sm">.00</div>':1===e?10>s?"0"+s+'<div class="sm">.00</div>':s+'<div class="sm">.00</div>':10>i?"0"+i+'<div class="sm">.00</div>':i+'<div class="sm">.00</div>'},_selectedHourForIndex:function(e){{var t=this.options;t.selectedTime.start,t.selectedTime.mid,t.selectedTime.end}return 0===e?t.selectedTime.start:1===e?t.selectedTime.mid:t.selectedTime.end
},_amOrPm:function(e){return 12>e?"AM":"PM"},_isToday:function(e){var t=this._cloneDate(e);this._clearTime(t);var n=new Date;return this._clearTime(n),n.getTime()===t.getTime()},_cleanEvents:function(t){var n=this;return e.each(t,function(e,t){n._cleanEvent(t)}),t},_cleanEvent:function(e){e.date&&(e.start=e.date),e.start=this._cleanDate(e.start),e.end=this._cleanDate(e.end),e.end||(e.end=this._addDays(this._cloneDate(e.start),1))},_disableTextSelect:function(t){t.each(function(){e.browser.mozilla?e(this).css("MozUserSelect","none"):e.browser.msie?e(this).bind("selectstart",function(){return!1}):e(this).mousedown(function(){return!1})})},_dateFirstDayOfWeek:function(e){var t=this,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=new Date(n);return s.setDate(s.getDate()-t._getAdjustedDayIndex(n)),s},_dateLastDayOfWeek:function(e){var t=this,n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=new Date(n),i=t.options.daysToShow-1-t._getAdjustedDayIndex(n);return s.setDate(s.getDate()+i),s},_fixMinMaxDate:function(e){var t,n;if(e=this._cleanDate(e),this.options.minDate&&(t=this._cleanDate(this.options.minDate),t=new Date(t.getFullYear(),t.getMonth(),t.getDate()),e.getTime()<t.getTime()&&this._trigger("reachedmindate",this.element,e),e=this._cleanDate(Math.max(e.getTime(),t.getTime()))),this.options.maxDate){if(n=this._cleanDate(this.options.maxDate),!this._startOnFirstDayOfWeek()){var s=n.getDate()-this.options.daysToShow+1;n=new Date(n.getFullYear(),n.getMonth(),s)}n=new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59,999),e.getTime()>n.getTime()&&this._trigger("reachedmaxdate",this.element,e),e=this._cleanDate(Math.min(e.getTime(),n.getTime()))}return e},_getAdjustedDayIndex:function(e){if(!this._startOnFirstDayOfWeek())return 0;var t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n=t.getDay(),s=[0,1,2,3,4,5,6];return this._rotate(s,this._firstDayOfWeek()),s[n]},_firstDayOfWeek:function(){return e.isFunction(this.options.firstDayOfWeek)?this.options.firstDayOfWeek(this.element):this.options.firstDayOfWeek},_dateLastMilliOfWeek:function(e){var t=this._dateLastDayOfWeek(e);return t=this._cloneDate(t),t.setDate(t.getDate()+1),t},_clearTime:function(e){return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e},_addDays:function(e,t,n){return e.setDate(e.getDate()+t),n?e:this._clearTime(e)},_rotate:function(e,t){for(var n,s,i=e.length,t=(Math.abs(t)>=i&&(t%=i),0>t&&(t+=i),t);t;t=(Math.ceil(i/t)-1)*t-i+(i=t))for(n=i;n>t;s=e[--n],e[n]=e[n-t],e[n-t]=s);return e},_cloneDate:function(e){return new Date(e.getTime())},_cleanDate:function(e){return"string"==typeof e?isNaN(Number(e))?Date.parse(e)||new Date(e):this._cleanDate(parseInt(e,10)):"number"==typeof e?new Date(e):e},_formatDate:function(e,t){for(var n="",s=0;s<t.length;s++){var i=t.charAt(s);0!=s&&"\\"==t.charAt(s-1)?n+=i:this._replaceChars[i]?n+=this._replaceChars[i](e,this):"\\"!=i&&(n+=i)}return n},_replaceChars:{d:function(e){return(e.getDate()<10?"0":"")+e.getDate()},D:function(e,t){return t.options.shortDays[e.getDay()]},j:function(e){return e.getDate()},l:function(e,t){return t.options.longDays[e.getDay()]},N:function(e){var t=e.getDay();return t?t:7},S:function(e){return e.getDate()%10==1&&11!=e.getDate()?"st":e.getDate()%10==2&&12!=e.getDate()?"nd":e.getDate()%10==3&&13!=e.getDate()?"rd":"th"},w:function(e){return e.getDay()},z:function(e){var t=new Date(e.getFullYear(),0,1);return Math.ceil((e-t)/864e5)},W:function(e){var t=new Date(e.getFullYear(),0,1);return Math.ceil(((e-t)/864e5+t.getDay()+1)/7)},F:function(e,t){return t.options.longMonths[e.getMonth()]},m:function(e){return(e.getMonth()<9?"0":"")+(e.getMonth()+1)},M:function(e,t){return t.options.shortMonths[e.getMonth()]},n:function(e){return e.getMonth()+1},t:function(e){var t=e;return new Date(t.getFullYear(),t.getMonth()+1,0).getDate()},L:function(e){var t=e.getFullYear();return t%400==0||t%100!=0&&t%4==0},o:function(e){var t=new Date(e.valueOf());return t.setDate(t.getDate()-(e.getDay()+6)%7+3),t.getFullYear()},Y:function(e){return e.getFullYear()},y:function(e){return(""+e.getFullYear()).substr(2)},a:function(e){return e.getHours()<12?"am":"pm"},A:function(e){return e.getHours()<12?"AM":"PM"},B:function(e){return Math.floor(1e3*((e.getUTCHours()+1)%24+e.getUTCMinutes()/60+e.getUTCSeconds()/3600)/24)},g:function(e){return e.getHours()%12||12},G:function(e){return e.getHours()},h:function(e){return((e.getHours()%12||12)<10?"0":"")+(e.getHours()%12||12)},H:function(e){return(e.getHours()<10?"0":"")+e.getHours()},i:function(e){return(e.getMinutes()<10?"0":"")+e.getMinutes()},s:function(e){return(e.getSeconds()<10?"0":"")+e.getSeconds()},u:function(e){var t=e.getMilliseconds();return(10>t?"00":100>t?"0":"")+t},e:function(){return"Not Yet Supported"},I:function(){return"Not Yet Supported"},O:function(e){return(-e.getTimezoneOffset()<0?"-":"+")+(Math.abs(e.getTimezoneOffset()/60)<10?"0":"")+Math.abs(e.getTimezoneOffset()/60)+"00"},P:function(e){return(-e.getTimezoneOffset()<0?"-":"+")+(Math.abs(e.getTimezoneOffset()/60)<10?"0":"")+Math.abs(e.getTimezoneOffset()/60)+":00"},T:function(e){var t=e.getMonth();e.setMonth(0);var n=e.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,"$1");return e.setMonth(t),n},Z:function(e){return 60*-e.getTimezoneOffset()},c:function(e,t){return t._formatDate(e,"Y-m-d\\TH:i:sP")},r:function(e,t){return t._formatDate(e,"D, d M Y H:i:s O")},U:function(e){return e.getTime()/1e3}},getUserForId:function(t){return e.extend({},this.options.users[this._getUserIndexFromId(t)])},_getUserName:function(t){var n=this,s=this.options,i=s.users[t];return e.isFunction(s.getUserName)?s.getUserName(i,t,n.element):i},_getUserIdFromIndex:function(t){var n=this,s=this.options;return e.isFunction(s.getUserId)?s.getUserId(s.users[t],t,n.element):t},_getUserIndexFromId:function(e){for(var t=this,n=this.options,s=0;s<n.users.length;s++)if(t._getUserIdFromIndex(s)==e)return s;return 0},_getEventUserId:function(t){var n=this,s=this.options;return s.showAsSeparateUsers&&s.users&&s.users.length?e.isFunction(s.getEventUserId)?s.getEventUserId(t,n.element):t.userId:[]},_setEventUserId:function(t,n){var s=this,i=this.options;return e.isFunction(i.setEventUserId)?i.setEventUserId(n,t,s.element):(t.userId=n,t)},_getFreeBusyUserId:function(t){var n=this,s=this.options;return e.isFunction(s.getFreeBusyUserId)?s.getFreeBusyUserId(t.getOption(),n.element):t.getOption("userId")},_clearFreeBusys:function(){if(this.options.displayFreeBusys){var t=this,n=this.options,s=t.element.find(".wc-grid-row-freebusy .wc-column-freebusy");s.each(function(){e(this).data("wcFreeBusyManager",new o({start:t._cloneDate(e(this).data("startDate")),end:t._cloneDate(e(this).data("endDate")),defaultFreeBusy:n.defaultFreeBusy||{}}))}),t.element.find(".wc-grid-row-freebusy .wc-freebusy").remove()}},_findWeekDaysForFreeBusy:function(t,n){var s,i=this.options,a=i.showAsSeparateUsers&&i.users&&i.users.length,r=this,o=r._getFreeBusyUserId(t);return e.isArray(o)||(o="undefined"!=o?[o]:[]),n||(n=r.element.find(".wc-grid-row-freebusy .wc-column-freebusy")),n.each(function(){var n=e(this).data("wcFreeBusyManager"),i=n.isWithin(t.getStart())||n.isWithin(t.getEnd())||t.isWithin(n.getStart())||t.isWithin(n.getEnd()),r=e(this).data("wcUserId");!i||a&&-1==e.inArray(r,o)||(s=s?s.add(e(this)):e(this))}),s},_renderFreeBusys:function(t){if(this.options.displayFreeBusys){var n,s=this,i=s.element.find(".wc-grid-row-freebusy .wc-column-freebusy");n=e.isArray(t)?s._cleanFreeBusys(t):t.freebusys?s._cleanFreeBusys(t.freebusys):[],e.each(n,function(t,n){var a=s._findWeekDaysForFreeBusy(n,i);a&&a.each(function(){var t=e(this).data("wcFreeBusyManager");t.insertFreeBusy(new r(n.getOption())),e(this).data("wcFreeBusyManager",t)})}),s._refreshFreeBusys(i)}},_refreshFreeBusys:function(t){if(this.options.displayFreeBusys&&t){var n=this,s=this.options,i=s.businessHours.limitDisplay?s.businessHours.start:0,a=s.businessHours.limitDisplay?s.businessHours.end:24;t.each(function(){var t=e(this),s=n._cloneDate(t.data("startDate")),r=n._cloneDate(s);s.setHours(i),r.setHours(a),t.find(".wc-freebusy").remove(),e.each(t.data("wcFreeBusyManager").getFreeBusys(s,r),function(){n._renderFreeBusy(this,t)})})}},_renderFreeBusy:function(t,n){if(this.options.displayFreeBusys){var s=this,i=this.options,a='<div class="wc-freebusy"></div>',o=e(a);o.data("wcFreeBusy",new r(t.getOption())),this._positionFreeBusy(n,o),o=i.freeBusyRender(t.getOption(),o,s.element),o&&o.appendTo(n)}},_positionFreeBusy:function(e,t){var n=this.options,s=t.data("wcFreeBusy"),i=e.height()/n.millisToDisplay,a=n.businessHours.limitDisplay?n.businessHours.start:0,r=s.getStart().getTime()-new Date(s.getStart().getFullYear(),s.getStart().getMonth(),s.getStart().getDate(),a).getTime(),o=s.getEnd().getTime()-s.getStart().getTime(),d=i*r,l=i*o;t.css({top:d,height:l})},_cleanFreeBusys:function(t){var n=this,s=[];if(!e.isArray(t))var t=[t];return e.each(t,function(e,t){s.push(new r(n._cleanFreeBusy(t)))}),s},_cleanFreeBusy:function(e){return e.date&&(e.start=e.date),e.start=this._cleanDate(e.start),e.end=this._cleanDate(e.end),e},getFreeBusyManagersFor:function(e,t){var n={start:e,end:e};return this._setEventUserId(n,t),this.getFreeBusyManagerForEvent(n)},getFreeBusyManagerForEvent:function(t){var n,s=this,i=this.options;if(i.displayFreeBusys){var a=s.element.find(".wc-grid-row-freebusy .wc-column-freebusy"),o=new r({start:t.start,end:t.end}),d=i.showAsSeparateUsers&&i.users&&i.users.length,l=d?s._getEventUserId(t):null;e.isArray(l)||(l=[l]),a.each(function(){var t=e(this).data("wcFreeBusyManager"),s=t.isWithin(o.getEnd())||t.isWithin(o.getEnd())||o.isWithin(t.getStart())||o.isWithin(t.getEnd());return!s||d&&-1==e.inArray(e(this).data("wcUserId"),l)?void 0:(n=e(this).data("wcFreeBusyManager"),!1)})}return n},updateFreeBusy:function(t){var n=this,s=this.options;if(s.displayFreeBusys){var i,a=n.element.find(".wc-grid-row-freebusy .wc-column-freebusy"),r=n._cleanFreeBusys(t);e.each(r,function(t,s){var r=n._findWeekDaysForFreeBusy(s,a);r&&r.length&&(r.each(function(t,n){var i=e(n).data("wcFreeBusyManager");i.insertFreeBusy(s),e(n).data("wcFreeBusyManager",i)}),i=i?i.add(r):r)}),n._refreshFreeBusys(i)}},_startOnFirstDayOfWeek:function(){return jQuery.isFunction(this.options.startOnFirstDayOfWeek)?this.options.startOnFirstDayOfWeek(this.element):this.options.startOnFirstDayOfWeek},_getCurrentScrollHour:function(){var e=this,t=this.options,n=this.element.find(".wc-scrollable-grid"),s=n.scrollTop();return e.options.businessHours.limitDisplay&&(s+=t.businessHours.start*t.timeslotHeight*t.timeslotsPerHour),Math.round(s/(t.timeslotHeight*t.timeslotsPerHour))+1},_getJsonOptions:function(){return e.isFunction(this.options.jsonOptions)?e.extend({},this.options.jsonOptions(this.element)):e.isPlainObject(this.options.jsonOptions)?e.extend({},this.options.jsonOptions):{}},_getHeaderDate:function(t){var n=this.options;if(n.getHeaderDate&&e.isFunction(n.getHeaderDate))return n.getHeaderDate(t,this.element);var s=n.useShortDayNames?n.shortDays[t.getDay()]:n.longDays[t.getDay()],i='<div class="day__name">'+s+"</div>";return i+this._formatDate(t,"d")},_getDSTdayShift:function(e,t){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0),s=n.getTimezoneOffset(),i=e.getTimezoneOffset();return s==i?e:(t=t?t:1,new Date(e.getTime()-t*(s>i?-1:1)*(Math.max(s,i)-Math.min(s,i))*6e4))},_needDSTdayShift:function(e,t){return e.getTimezoneOffset()!=t.getTimezoneOffset()}}}()),e.extend(e.ui.weekCalendar,{version:"2.0-dev",updateLayoutOptions:{startOnFirstDayOfWeek:!0,firstDayOfWeek:!0,daysToShow:!0,displayOddEven:!0,timeFormat:!0,dateFormat:!0,use24Hour:!0,useShortDayNames:!0,businessHours:!0,timeslotHeight:!0,timeslotsPerHour:!0,buttonText:!0,height:!0,shortMonths:!0,longMonths:!0,shortDays:!0,longDays:!0,textSize:!0,users:!0,showAsSeparateUsers:!0,displayFreeBusys:!0}});var s=864e5,i=7*s,a={getStart:function(){return this.getOption("start")},getEnd:function(){return this.getOption("end")},getOption:function(){return arguments.length?"undefined"!=typeof this.options[arguments[0]]?this.options[arguments[0]]:"undefined"!=typeof arguments[1]?arguments[1]:null:this.options},setOption:function(t,n){return 1==arguments.length?(e.extend(this.options,arguments[0]),this):(this.options[t]=n,this)},isWithin:function(e){return Math.floor(e.getTime()/1e3)>=Math.floor(this.getStart().getTime()/1e3)&&Math.floor(e.getTime()/1e3)<=Math.floor(this.getEnd().getTime()/1e3)},isValid:function(){return this.getStart().getTime()<this.getEnd().getTime()}},r=function(t){this.options=e.extend({},t||{})};e.extend(r.prototype,a);var o=function(t){this.options=e.extend({defaultFreeBusy:{}},t||{}),this.freeBusys=[],this.freeBusys.push(new r(e.extend({start:this.getStart(),end:this.getEnd()},this.options.defaultFreeBusy)))};e.extend(o.prototype,a,{getFreeBusys:function(){switch(arguments.length){case 0:return this.freeBusys;case 1:var t=[],n=arguments[0];return this.isWithin(n)?(e.each(this.freeBusys,function(){return this.isWithin(n)&&t.push(this),Math.floor(this.getEnd().getTime()/1e3)>Math.floor(n.getTime()/1e3)?!1:void 0}),t):t;default:var t=[],n=arguments[0],s=arguments[1],i=new r({start:n,end:s});return s.getTime()<n.getTime()||this.getStart().getTime()>s.getTime()||this.getEnd().getTime()<n.getTime()?t:(e.each(this.freeBusys,function(){if(this.getStart().getTime()>=s.getTime())return!1;if(i.isWithin(this.getStart())&&i.isWithin(this.getEnd()))t.push(this);else if(this.isWithin(i.getStart())&&this.isWithin(i.getEnd())){var e=new r(this.getOption());e.setOption("end",i.getEnd()),e.setOption("start",i.getStart()),t.push(e)}else if(this.isWithin(i.getStart())&&this.getStart().getTime()<n.getTime()){var e=new r(this.getOption());e.setOption("start",i.getStart()),t.push(e)}else if(this.isWithin(i.getEnd())&&this.getEnd().getTime()>s.getTime()){var e=new r(this.getOption());e.setOption("end",i.getEnd()),t.push(e)}}),t)}},insertFreeBusy:function(t){var t=new r(t.getOption());t.getStart().getTime()<this.getStart().getTime()&&t.setOption("start",this.getStart()),t.getEnd().getTime()>this.getEnd().getTime()&&t.setOption("end",this.getEnd());var n=t.getStart(),s=t.getEnd(),i=0,a=this.freeBusys.length-1,o=[],d=function(e){e.isValid()&&o.push(e)};e.each(this.freeBusys,function(e){var o=this;if(o.isWithin(n)&&o.isWithin(s)){if(i=e,a=e,n.getTime()==o.getStart().getTime()&&s.getTime()==o.getEnd().getTime()){var l=new r(t.getOption());d(l)}else if(n.getTime()==o.getStart().getTime()){var l=new r(t.getOption()),u=new r(o.getOption());u.setOption("start",s),d(l),d(u)}else if(s.getTime()==o.getEnd().getTime()){var l=new r(o.getOption());l.setOption("end",n);var u=new r(t.getOption());d(l),d(u)}else{var l=new r(o.getOption()),u=new r(t.getOption()),c=new r(o.getOption());l.setOption("end",n),c.setOption("start",s),d(l),d(u),d(c)}return!1}if(o.isWithin(n)&&o.getEnd().getTime()!=n.getTime()){if(o.getStart().getTime()!=n.getTime()){var l=new r(o.getOption());l.setOption("end",n),d(l)}i=e}else if(o.isWithin(s)&&o.getStart().getTime()!=s.getTime()){if(d(new r(t.getOption())),s.getTime()<o.getEnd().getTime()){var l=new r(o.getOption());l.setOption("start",s),d(l)}return a=e,!1}});var l=this.freeBusys;return this.freeBusys=[],i&&(this.freeBusys=this.freeBusys.concat(l.slice(0,i))),this.freeBusys=this.freeBusys.concat(o),a<l.length&&(this.freeBusys=this.freeBusys.concat(l.slice(a+1))),this}})}(jQuery);